language: cpp
matrix:
  include:
    - os: linux
      dist: xenial
      sudo: true
      compiler: gcc
      addons:
        apt:
          packages:
          - gcc-7
          - g++-7
          - cmake
          - libfftw3-dev
          - libsamplerate0-dev
          - libaudiofile-dev
          - libsndfile1-dev
          - libgtest-dev
          - libboost-all-dev
          sources:
          - ubuntu-toolchain-r-test
          - llvm-toolchain-trusty-5.0
      env:
          - MATRIX_EVAL="CC=gcc-7 && CXX=g++-7"

before_install:
  - eval "${MATRIX_EVAL}"
  - pip install --user cpp-coveralls
  - cd /usr/src/gtest
  - sudo cmake CMakeLists.txt
  - sudo make
  - sudo cp *.a /usr/lib
  - cd -

notifications:
  email: false

script:
  - mkdir -p build
  - cd build
  - cmake -DBUILD_TESTS=ON -DBUILD_DOCS=OFF -DBUILD_EXAMPLES=ON ..
  - make -j4
  - make test